"use strict";(globalThis.webpackChunkphysical_ai_humanoid_robotics_book=globalThis.webpackChunkphysical_ai_humanoid_robotics_book||[]).push([[8070],{16249:(s,e,n)=>{n.r(e),n.d(e,{assets:()=>c,contentTitle:()=>t,default:()=>h,frontMatter:()=>i,metadata:()=>r,toc:()=>o});const r=JSON.parse('{"id":"chapters/module-5-capstone/control-stack","title":"Chapter 3: Control Stack","description":"Whole-body control, balance, and joint-level control for humanoid robots","source":"@site/docs/chapters/module-5-capstone/03-control-stack.md","sourceDirName":"chapters/module-5-capstone","slug":"/chapters/module-5-capstone/control-stack","permalink":"/Physical-AI-Humanoid-Robotics/docs/chapters/module-5-capstone/control-stack","draft":false,"unlisted":false,"editUrl":"https://github.com/ayeshadev283-max/Physical-AI-Humanoid-Robotics/tree/main/docs/chapters/module-5-capstone/03-control-stack.md","tags":[{"inline":true,"label":"control","permalink":"/Physical-AI-Humanoid-Robotics/docs/tags/control"},{"inline":true,"label":"whole-body","permalink":"/Physical-AI-Humanoid-Robotics/docs/tags/whole-body"},{"inline":true,"label":"balance","permalink":"/Physical-AI-Humanoid-Robotics/docs/tags/balance"},{"inline":true,"label":"zmp","permalink":"/Physical-AI-Humanoid-Robotics/docs/tags/zmp"},{"inline":true,"label":"mpc","permalink":"/Physical-AI-Humanoid-Robotics/docs/tags/mpc"},{"inline":true,"label":"pid","permalink":"/Physical-AI-Humanoid-Robotics/docs/tags/pid"}],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3,"title":"Chapter 3: Control Stack","description":"Whole-body control, balance, and joint-level control for humanoid robots","tags":["control","whole-body","balance","zmp","mpc","pid"]},"sidebar":"bookSidebar","previous":{"title":"Chapter 2: Perception Stack","permalink":"/Physical-AI-Humanoid-Robotics/docs/chapters/module-5-capstone/perception-stack"},"next":{"title":"Chapter 4: VLA Autonomy","permalink":"/Physical-AI-Humanoid-Robotics/docs/chapters/module-5-capstone/vla-autonomy"}}');var a=n(74848),l=n(28453);const i={sidebar_position:3,title:"Chapter 3: Control Stack",description:"Whole-body control, balance, and joint-level control for humanoid robots",tags:["control","whole-body","balance","zmp","mpc","pid"]},t="Chapter 3: Control Stack",c={},o=[{value:"Learning Objectives",id:"learning-objectives",level:2},{value:"3.1 Whole-Body Control Architecture",id:"31-whole-body-control-architecture",level:2},{value:"Control Hierarchy",id:"control-hierarchy",level:3},{value:"Quadratic Programming (QP) Formulation",id:"quadratic-programming-qp-formulation",level:3},{value:"Prioritized Tasks",id:"prioritized-tasks",level:3},{value:"3.2 Balance Controller",id:"32-balance-controller",level:2},{value:"Zero Moment Point (ZMP)",id:"zero-moment-point-zmp",level:3},{value:"Model Predictive Control (MPC)",id:"model-predictive-control-mpc",level:3},{value:"3.3 Joint-Level Control",id:"33-joint-level-control",level:2},{value:"PID Tuning",id:"pid-tuning",level:3},{value:"Impedance Control",id:"impedance-control",level:3},{value:"Exercises",id:"exercises",level:2},{value:"Summary",id:"summary",level:2}];function m(s){const e={annotation:"annotation",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",math:"math",mermaid:"mermaid",mi:"mi",mn:"mn",mo:"mo",mover:"mover",mrow:"mrow",msub:"msub",ol:"ol",p:"p",pre:"pre",semantics:"semantics",span:"span",strong:"strong",ul:"ul",...(0,l.R)(),...s.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(e.header,{children:(0,a.jsx)(e.h1,{id:"chapter-3-control-stack",children:"Chapter 3: Control Stack"})}),"\n",(0,a.jsx)(e.h2,{id:"learning-objectives",children:"Learning Objectives"}),"\n",(0,a.jsxs)(e.ol,{children:["\n",(0,a.jsx)(e.li,{children:"Implement whole-body controller for coordinated motion"}),"\n",(0,a.jsx)(e.li,{children:"Design balance controller using ZMP or MPC"}),"\n",(0,a.jsx)(e.li,{children:"Tune joint-level PID controllers for tracking"}),"\n"]}),"\n",(0,a.jsx)(e.h2,{id:"31-whole-body-control-architecture",children:"3.1 Whole-Body Control Architecture"}),"\n",(0,a.jsx)(e.h3,{id:"control-hierarchy",children:"Control Hierarchy"}),"\n",(0,a.jsxs)(e.p,{children:[(0,a.jsx)(e.strong,{children:"Three-Layer Architecture"}),":"]}),"\n",(0,a.jsxs)(e.ol,{children:["\n",(0,a.jsxs)(e.li,{children:[(0,a.jsx)(e.strong,{children:"High-Level"})," (10 Hz): Task-space commands (end-effector poses, CoM trajectory)"]}),"\n",(0,a.jsxs)(e.li,{children:[(0,a.jsx)(e.strong,{children:"Mid-Level"})," (100 Hz): Whole-body QP optimization (joint torques/accelerations)"]}),"\n",(0,a.jsxs)(e.li,{children:[(0,a.jsx)(e.strong,{children:"Low-Level"})," (1000 Hz): Joint PID control (motor commands)"]}),"\n"]}),"\n",(0,a.jsx)(e.mermaid,{value:"graph TB\r\n    HighLevel[High-Level Planner<br/>Task-space goals]\r\n    --\x3e |Desired EE pose, CoM| WBC[Whole-Body Controller<br/>QP Optimization]\r\n\r\n    WBC --\x3e |Joint torques| Balance[Balance Controller<br/>ZMP/DCM]\r\n\r\n    Balance --\x3e |Adjusted torques| JointPID[Joint PID Controllers<br/>30x motors]\r\n\r\n    JointPID --\x3e Motors[Motors<br/>Execute commands]\r\n\r\n    IMU[IMU] --\x3e Balance\r\n    FT[Force/Torque<br/>Sensors] --\x3e Balance\r\n    Encoders[Joint Encoders] --\x3e JointPID\r\n\r\n    style WBC fill:#e1f5ff\r\n    style Balance fill:#ffffcc\r\n    style JointPID fill:#ffe1e1"}),"\n",(0,a.jsxs)(e.p,{children:[(0,a.jsx)(e.strong,{children:"Figure 3.1"}),": Control hierarchy showing high-level task commands flowing through whole-body QP, balance controller, and joint PIDs with sensor feedback loops."]}),"\n",(0,a.jsx)(e.h3,{id:"quadratic-programming-qp-formulation",children:"Quadratic Programming (QP) Formulation"}),"\n",(0,a.jsxs)(e.p,{children:[(0,a.jsx)(e.strong,{children:"Goal"}),": Find joint accelerations ",(0,a.jsxs)(e.span,{className:"katex",children:[(0,a.jsx)(e.span,{className:"katex-mathml",children:(0,a.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsx)(e.mrow,{children:(0,a.jsxs)(e.mover,{accent:"true",children:[(0,a.jsx)(e.mi,{children:"q"}),(0,a.jsx)(e.mo,{children:"\xa8"})]})}),(0,a.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\ddot{q}"})]})})}),(0,a.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,a.jsxs)(e.span,{className:"base",children:[(0,a.jsx)(e.span,{className:"strut",style:{height:"0.8623em",verticalAlign:"-0.1944em"}}),(0,a.jsx)(e.span,{className:"mord accent",children:(0,a.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,a.jsxs)(e.span,{className:"vlist-r",children:[(0,a.jsxs)(e.span,{className:"vlist",style:{height:"0.6679em"},children:[(0,a.jsxs)(e.span,{style:{top:"-3em"},children:[(0,a.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,a.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"q"})]}),(0,a.jsxs)(e.span,{style:{top:"-3em"},children:[(0,a.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,a.jsx)(e.span,{className:"accent-body",style:{left:"-0.1667em"},children:(0,a.jsx)(e.span,{className:"mord",children:"\xa8"})})]})]}),(0,a.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,a.jsx)(e.span,{className:"vlist-r",children:(0,a.jsx)(e.span,{className:"vlist",style:{height:"0.1944em"},children:(0,a.jsx)(e.span,{})})})]})})]})})]})," that achieve multiple tasks while respecting constraints"]}),"\n",(0,a.jsxs)(e.p,{children:[(0,a.jsx)(e.strong,{children:"Optimization Problem"}),":"]}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{children:"minimize:   || J_ee * q\u0308 - \u1e8d_ee_des ||\xb2     (end-effector task)\r\n          + || J_com * q\u0308 - \u1e8d_com_des ||\xb2   (CoM task)\r\n          + || q\u0308 ||\xb2                        (regularization)\r\n\r\nsubject to: M * q\u0308 + h = \u03c4                  (dynamics)\r\n            \u03c4_min \u2264 \u03c4 \u2264 \u03c4_max               (torque limits)\r\n            J_contact * q\u0308 = 0               (contact constraints)\n"})}),"\n",(0,a.jsxs)(e.p,{children:[(0,a.jsx)(e.strong,{children:"Implementation"})," (using ",(0,a.jsx)(e.code,{children:"qpsolvers"}),"):"]}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-python",children:'import numpy as np\r\nfrom qpsolvers import solve_qp\r\n\r\nclass WholeBodyController:\r\n    def __init__(self, robot_model):\r\n        self.robot = robot_model\r\n        self.n_joints = robot_model.nq\r\n\r\n    def solve(self, q, q_dot, ee_pose_des, com_pos_des):\r\n        """\r\n        Solve QP for joint accelerations\r\n\r\n        Args:\r\n            q: Joint positions (n,)\r\n            q_dot: Joint velocities (n,)\r\n            ee_pose_des: Desired end-effector pose (6,)\r\n            com_pos_des: Desired CoM position (3,)\r\n\r\n        Returns:\r\n            tau: Joint torques (n,)\r\n        """\r\n        # Compute Jacobians\r\n        J_ee = self.robot.get_ee_jacobian(q)  # (6, n)\r\n        J_com = self.robot.get_com_jacobian(q)  # (3, n)\r\n\r\n        # Desired accelerations\r\n        ee_error = ee_pose_des - self.robot.get_ee_pose(q)\r\n        com_error = com_pos_des - self.robot.get_com_position(q)\r\n\r\n        # PD control law\r\n        kp_ee, kd_ee = 100, 20\r\n        kp_com, kd_com = 200, 40\r\n\r\n        acc_ee_des = kp_ee * ee_error - kd_ee * (J_ee @ q_dot)\r\n        acc_com_des = kp_com * com_error - kd_com * (J_com @ q_dot)\r\n\r\n        # QP matrices\r\n        # Minimize: 1/2 q\u0308^T P q\u0308 + q^T q\u0308\r\n        P = J_ee.T @ J_ee + J_com.T @ J_com + 0.001 * np.eye(self.n_joints)\r\n        q_vec = -J_ee.T @ acc_ee_des - J_com.T @ acc_com_des\r\n\r\n        # Equality constraint: M * q\u0308 + h = \u03c4 (dynamics)\r\n        M = self.robot.get_mass_matrix(q)\r\n        h = self.robot.get_nonlinear_effects(q, q_dot)\r\n\r\n        # Torque limits\r\n        tau_max = self.robot.torque_limits\r\n        G = np.vstack([np.eye(self.n_joints), -np.eye(self.n_joints)])\r\n        h_ineq = np.hstack([tau_max, tau_max])\r\n\r\n        # Solve QP\r\n        q_ddot = solve_qp(P, q_vec, G, h_ineq, solver=\'quadprog\')\r\n\r\n        # Compute torques\r\n        tau = M @ q_ddot + h\r\n\r\n        return tau\n'})}),"\n",(0,a.jsx)(e.h3,{id:"prioritized-tasks",children:"Prioritized Tasks"}),"\n",(0,a.jsxs)(e.p,{children:[(0,a.jsx)(e.strong,{children:"Use Case"}),": High-priority task (balance) vs low-priority task (arm motion)"]}),"\n",(0,a.jsxs)(e.p,{children:[(0,a.jsx)(e.strong,{children:"Hierarchical QP"}),":"]}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-python",children:'class PrioritizedWBC(WholeBodyController):\r\n    def solve_hierarchical(self, q, q_dot, tasks_prioritized):\r\n        """\r\n        Solve tasks in order of priority\r\n\r\n        Args:\r\n            tasks_prioritized: List of (Jacobian, acc_des, weight) tuples\r\n                               Ordered from high to low priority\r\n\r\n        Returns:\r\n            tau: Joint torques\r\n        """\r\n        q_ddot = np.zeros(self.n_joints)\r\n\r\n        for J, acc_des, weight in tasks_prioritized:\r\n            # Minimize: || J * q\u0308 - acc_des ||\xb2 + || q\u0308 - q\u0308_prev ||\xb2\r\n            P = J.T @ J + weight * np.eye(self.n_joints)\r\n            q_vec = -J.T @ acc_des + weight * q_ddot\r\n\r\n            # Solve\r\n            q_ddot = solve_qp(P, q_vec)\r\n\r\n        # Dynamics\r\n        M = self.robot.get_mass_matrix(q)\r\n        h = self.robot.get_nonlinear_effects(q, q_dot)\r\n        tau = M @ q_ddot + h\r\n\r\n        return tau\n'})}),"\n",(0,a.jsx)(e.h2,{id:"32-balance-controller",children:"3.2 Balance Controller"}),"\n",(0,a.jsx)(e.h3,{id:"zero-moment-point-zmp",children:"Zero Moment Point (ZMP)"}),"\n",(0,a.jsxs)(e.p,{children:[(0,a.jsx)(e.strong,{children:"Definition"}),": Point on the ground where net moment is zero"]}),"\n",(0,a.jsxs)(e.p,{children:[(0,a.jsx)(e.strong,{children:"Condition for Stability"}),": ZMP must be inside support polygon (footprint)"]}),"\n",(0,a.jsxs)(e.p,{children:[(0,a.jsx)(e.strong,{children:"ZMP Computation"}),":"]}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-python",children:'class ZMPController:\r\n    def __init__(self, robot):\r\n        self.robot = robot\r\n        self.g = 9.81\r\n\r\n    def compute_zmp(self, q, q_dot, q_ddot):\r\n        """\r\n        Compute ZMP position from robot state\r\n\r\n        Returns:\r\n            zmp: (2,) - ZMP position in (x, y)\r\n        """\r\n        # Center of mass\r\n        com_pos = self.robot.get_com_position(q)\r\n        com_vel = self.robot.get_com_velocity(q, q_dot)\r\n        com_acc = self.robot.get_com_acceleration(q, q_dot, q_ddot)\r\n\r\n        # ZMP formula (assuming flat ground at z=0)\r\n        zmp_x = com_pos[0] - (com_pos[2] / (com_acc[2] + self.g)) * com_acc[0]\r\n        zmp_y = com_pos[1] - (com_pos[2] / (com_acc[2] + self.g)) * com_acc[1]\r\n\r\n        return np.array([zmp_x, zmp_y])\r\n\r\n    def is_stable(self, zmp, support_polygon):\r\n        """\r\n        Check if ZMP is inside support polygon\r\n\r\n        Args:\r\n            zmp: (2,) ZMP position\r\n            support_polygon: (N, 2) vertices of support polygon\r\n\r\n        Returns:\r\n            bool: True if stable\r\n        """\r\n        from matplotlib.path import Path\r\n        polygon = Path(support_polygon)\r\n        return polygon.contains_point(zmp)\n'})}),"\n",(0,a.jsxs)(e.p,{children:[(0,a.jsx)(e.strong,{children:"ZMP-Based Walking"}),":"]}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-python",children:'def generate_zmp_trajectory(footstep_plan, com_height=0.8):\r\n    """\r\n    Generate ZMP trajectory for walking\r\n\r\n    Args:\r\n        footstep_plan: List of (x, y, theta) footstep poses\r\n        com_height: Desired CoM height\r\n\r\n    Returns:\r\n        zmp_traj: (T, 2) ZMP trajectory\r\n        com_traj: (T, 3) CoM trajectory\r\n    """\r\n    zmp_traj = []\r\n    com_traj = []\r\n\r\n    for i in range(len(footstep_plan) - 1):\r\n        # ZMP stays at current foot during swing phase\r\n        foot_current = footstep_plan[i][:2]\r\n        foot_next = footstep_plan[i+1][:2]\r\n\r\n        # Double support: ZMP at midpoint\r\n        zmp_double = (foot_current + foot_next) / 2\r\n\r\n        # Single support: ZMP at stance foot\r\n        zmp_single = foot_current\r\n\r\n        # Trajectory (10 steps per phase)\r\n        for t in range(10):\r\n            zmp_traj.append(zmp_single)\r\n\r\n        for t in range(10):\r\n            zmp_traj.append(zmp_double)\r\n\r\n        # CoM follows ZMP with offset\r\n        com_x = zmp_single[0]\r\n        com_y = zmp_single[1]\r\n        com_traj.append([com_x, com_y, com_height])\r\n\r\n    return np.array(zmp_traj), np.array(com_traj)\n'})}),"\n",(0,a.jsx)(e.h3,{id:"model-predictive-control-mpc",children:"Model Predictive Control (MPC)"}),"\n",(0,a.jsxs)(e.p,{children:[(0,a.jsx)(e.strong,{children:"Formulation"}),":"]}),"\n",(0,a.jsxs)(e.p,{children:["Predict future states over horizon ",(0,a.jsxs)(e.span,{className:"katex",children:[(0,a.jsx)(e.span,{className:"katex-mathml",children:(0,a.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsx)(e.mrow,{children:(0,a.jsx)(e.mi,{children:"N"})}),(0,a.jsx)(e.annotation,{encoding:"application/x-tex",children:"N"})]})})}),(0,a.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,a.jsxs)(e.span,{className:"base",children:[(0,a.jsx)(e.span,{className:"strut",style:{height:"0.6833em"}}),(0,a.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.10903em"},children:"N"})]})})]})," and optimize control inputs:"]}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{children:"minimize:   \u03a3 || x_k - x_ref ||\xb2_Q + || u_k ||\xb2_R\r\n\r\nsubject to: x_{k+1} = A x_k + B u_k     (linear dynamics)\r\n            x_min \u2264 x_k \u2264 x_max         (state limits)\r\n            u_min \u2264 u_k \u2264 u_max         (control limits)\n"})}),"\n",(0,a.jsxs)(e.p,{children:[(0,a.jsx)(e.strong,{children:"Implementation"})," (using ",(0,a.jsx)(e.code,{children:"cvxpy"}),"):"]}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-python",children:'import cvxpy as cp\r\n\r\nclass MPCBalanceController:\r\n    def __init__(self, dt=0.01, horizon=20):\r\n        self.dt = dt\r\n        self.N = horizon\r\n\r\n        # Linearized CoM dynamics (inverted pendulum)\r\n        # \u1e8d = g/h * x (where h = CoM height)\r\n        self.g = 9.81\r\n        self.h = 0.8\r\n\r\n        # Discretize: x_{k+1} = A x_k + B u_k\r\n        # State: [pos, vel], Control: [acc]\r\n        self.A = np.array([[1, dt], [0, 1 + (self.g/self.h)*dt**2]])\r\n        self.B = np.array([[0], [dt]])\r\n\r\n    def solve(self, x0, x_ref):\r\n        """\r\n        Solve MPC for CoM control\r\n\r\n        Args:\r\n            x0: Initial state [pos, vel]\r\n            x_ref: Reference trajectory (N, 2)\r\n\r\n        Returns:\r\n            u_opt: Optimal control sequence (N, 1)\r\n        """\r\n        n_states = 2\r\n        n_controls = 1\r\n\r\n        # Decision variables\r\n        x = cp.Variable((self.N + 1, n_states))\r\n        u = cp.Variable((self.N, n_controls))\r\n\r\n        # Cost matrices\r\n        Q = np.diag([100, 10])  # Position and velocity weights\r\n        R = np.diag([1])        # Control effort weight\r\n\r\n        # Objective\r\n        cost = 0\r\n        for k in range(self.N):\r\n            cost += cp.quad_form(x[k] - x_ref[k], Q)\r\n            cost += cp.quad_form(u[k], R)\r\n\r\n        # Constraints\r\n        constraints = [x[0] == x0]\r\n        for k in range(self.N):\r\n            constraints += [x[k+1] == self.A @ x[k] + self.B @ u[k]]\r\n            constraints += [cp.abs(u[k]) <= 5.0]  # Acceleration limits\r\n\r\n        # Solve\r\n        problem = cp.Problem(cp.Minimize(cost), constraints)\r\n        problem.solve(solver=cp.OSQP)\r\n\r\n        return u.value\n'})}),"\n",(0,a.jsx)(e.h2,{id:"33-joint-level-control",children:"3.3 Joint-Level Control"}),"\n",(0,a.jsx)(e.h3,{id:"pid-tuning",children:"PID Tuning"}),"\n",(0,a.jsxs)(e.p,{children:[(0,a.jsx)(e.strong,{children:"Ziegler-Nichols Method"}),":"]}),"\n",(0,a.jsxs)(e.ol,{children:["\n",(0,a.jsxs)(e.li,{children:["Set ",(0,a.jsxs)(e.span,{className:"katex",children:[(0,a.jsx)(e.span,{className:"katex-mathml",children:(0,a.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsxs)(e.mrow,{children:[(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:"K"}),(0,a.jsx)(e.mi,{children:"i"})]}),(0,a.jsx)(e.mo,{children:"="}),(0,a.jsx)(e.mn,{children:"0"})]}),(0,a.jsx)(e.annotation,{encoding:"application/x-tex",children:"K_i = 0"})]})})}),(0,a.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,a.jsxs)(e.span,{className:"base",children:[(0,a.jsx)(e.span,{className:"strut",style:{height:"0.8333em",verticalAlign:"-0.15em"}}),(0,a.jsxs)(e.span,{className:"mord",children:[(0,a.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.07153em"},children:"K"}),(0,a.jsx)(e.span,{className:"msupsub",children:(0,a.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,a.jsxs)(e.span,{className:"vlist-r",children:[(0,a.jsx)(e.span,{className:"vlist",style:{height:"0.3117em"},children:(0,a.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0715em",marginRight:"0.05em"},children:[(0,a.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,a.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,a.jsx)(e.span,{className:"mord mathnormal mtight",children:"i"})})]})}),(0,a.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,a.jsx)(e.span,{className:"vlist-r",children:(0,a.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,a.jsx)(e.span,{className:"mrel",children:"="}),(0,a.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,a.jsxs)(e.span,{className:"base",children:[(0,a.jsx)(e.span,{className:"strut",style:{height:"0.6444em"}}),(0,a.jsx)(e.span,{className:"mord",children:"0"})]})]})]}),", ",(0,a.jsxs)(e.span,{className:"katex",children:[(0,a.jsx)(e.span,{className:"katex-mathml",children:(0,a.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsxs)(e.mrow,{children:[(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:"K"}),(0,a.jsx)(e.mi,{children:"d"})]}),(0,a.jsx)(e.mo,{children:"="}),(0,a.jsx)(e.mn,{children:"0"})]}),(0,a.jsx)(e.annotation,{encoding:"application/x-tex",children:"K_d = 0"})]})})}),(0,a.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,a.jsxs)(e.span,{className:"base",children:[(0,a.jsx)(e.span,{className:"strut",style:{height:"0.8333em",verticalAlign:"-0.15em"}}),(0,a.jsxs)(e.span,{className:"mord",children:[(0,a.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.07153em"},children:"K"}),(0,a.jsx)(e.span,{className:"msupsub",children:(0,a.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,a.jsxs)(e.span,{className:"vlist-r",children:[(0,a.jsx)(e.span,{className:"vlist",style:{height:"0.3361em"},children:(0,a.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0715em",marginRight:"0.05em"},children:[(0,a.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,a.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,a.jsx)(e.span,{className:"mord mathnormal mtight",children:"d"})})]})}),(0,a.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,a.jsx)(e.span,{className:"vlist-r",children:(0,a.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,a.jsx)(e.span,{className:"mrel",children:"="}),(0,a.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,a.jsxs)(e.span,{className:"base",children:[(0,a.jsx)(e.span,{className:"strut",style:{height:"0.6444em"}}),(0,a.jsx)(e.span,{className:"mord",children:"0"})]})]})]})]}),"\n",(0,a.jsxs)(e.li,{children:["Increase ",(0,a.jsxs)(e.span,{className:"katex",children:[(0,a.jsx)(e.span,{className:"katex-mathml",children:(0,a.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsx)(e.mrow,{children:(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:"K"}),(0,a.jsx)(e.mi,{children:"p"})]})}),(0,a.jsx)(e.annotation,{encoding:"application/x-tex",children:"K_p"})]})})}),(0,a.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,a.jsxs)(e.span,{className:"base",children:[(0,a.jsx)(e.span,{className:"strut",style:{height:"0.9694em",verticalAlign:"-0.2861em"}}),(0,a.jsxs)(e.span,{className:"mord",children:[(0,a.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.07153em"},children:"K"}),(0,a.jsx)(e.span,{className:"msupsub",children:(0,a.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,a.jsxs)(e.span,{className:"vlist-r",children:[(0,a.jsx)(e.span,{className:"vlist",style:{height:"0.1514em"},children:(0,a.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0715em",marginRight:"0.05em"},children:[(0,a.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,a.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,a.jsx)(e.span,{className:"mord mathnormal mtight",children:"p"})})]})}),(0,a.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,a.jsx)(e.span,{className:"vlist-r",children:(0,a.jsx)(e.span,{className:"vlist",style:{height:"0.2861em"},children:(0,a.jsx)(e.span,{})})})]})})]})]})})]})," until oscillation (critical gain ",(0,a.jsxs)(e.span,{className:"katex",children:[(0,a.jsx)(e.span,{className:"katex-mathml",children:(0,a.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsx)(e.mrow,{children:(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:"K"}),(0,a.jsx)(e.mi,{children:"u"})]})}),(0,a.jsx)(e.annotation,{encoding:"application/x-tex",children:"K_u"})]})})}),(0,a.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,a.jsxs)(e.span,{className:"base",children:[(0,a.jsx)(e.span,{className:"strut",style:{height:"0.8333em",verticalAlign:"-0.15em"}}),(0,a.jsxs)(e.span,{className:"mord",children:[(0,a.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.07153em"},children:"K"}),(0,a.jsx)(e.span,{className:"msupsub",children:(0,a.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,a.jsxs)(e.span,{className:"vlist-r",children:[(0,a.jsx)(e.span,{className:"vlist",style:{height:"0.1514em"},children:(0,a.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0715em",marginRight:"0.05em"},children:[(0,a.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,a.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,a.jsx)(e.span,{className:"mord mathnormal mtight",children:"u"})})]})}),(0,a.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,a.jsx)(e.span,{className:"vlist-r",children:(0,a.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,a.jsx)(e.span,{})})})]})})]})]})})]}),")"]}),"\n",(0,a.jsxs)(e.li,{children:["Measure oscillation period ",(0,a.jsxs)(e.span,{className:"katex",children:[(0,a.jsx)(e.span,{className:"katex-mathml",children:(0,a.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsx)(e.mrow,{children:(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:"T"}),(0,a.jsx)(e.mi,{children:"u"})]})}),(0,a.jsx)(e.annotation,{encoding:"application/x-tex",children:"T_u"})]})})}),(0,a.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,a.jsxs)(e.span,{className:"base",children:[(0,a.jsx)(e.span,{className:"strut",style:{height:"0.8333em",verticalAlign:"-0.15em"}}),(0,a.jsxs)(e.span,{className:"mord",children:[(0,a.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.13889em"},children:"T"}),(0,a.jsx)(e.span,{className:"msupsub",children:(0,a.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,a.jsxs)(e.span,{className:"vlist-r",children:[(0,a.jsx)(e.span,{className:"vlist",style:{height:"0.1514em"},children:(0,a.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.1389em",marginRight:"0.05em"},children:[(0,a.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,a.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,a.jsx)(e.span,{className:"mord mathnormal mtight",children:"u"})})]})}),(0,a.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,a.jsx)(e.span,{className:"vlist-r",children:(0,a.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,a.jsx)(e.span,{})})})]})})]})]})})]})]}),"\n",(0,a.jsxs)(e.li,{children:["Compute PID gains:","\n",(0,a.jsxs)(e.ul,{children:["\n",(0,a.jsx)(e.li,{children:(0,a.jsxs)(e.span,{className:"katex",children:[(0,a.jsx)(e.span,{className:"katex-mathml",children:(0,a.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsxs)(e.mrow,{children:[(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:"K"}),(0,a.jsx)(e.mi,{children:"p"})]}),(0,a.jsx)(e.mo,{children:"="}),(0,a.jsx)(e.mn,{children:"0.6"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:"K"}),(0,a.jsx)(e.mi,{children:"u"})]})]}),(0,a.jsx)(e.annotation,{encoding:"application/x-tex",children:"K_p = 0.6 K_u"})]})})}),(0,a.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,a.jsxs)(e.span,{className:"base",children:[(0,a.jsx)(e.span,{className:"strut",style:{height:"0.9694em",verticalAlign:"-0.2861em"}}),(0,a.jsxs)(e.span,{className:"mord",children:[(0,a.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.07153em"},children:"K"}),(0,a.jsx)(e.span,{className:"msupsub",children:(0,a.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,a.jsxs)(e.span,{className:"vlist-r",children:[(0,a.jsx)(e.span,{className:"vlist",style:{height:"0.1514em"},children:(0,a.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0715em",marginRight:"0.05em"},children:[(0,a.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,a.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,a.jsx)(e.span,{className:"mord mathnormal mtight",children:"p"})})]})}),(0,a.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,a.jsx)(e.span,{className:"vlist-r",children:(0,a.jsx)(e.span,{className:"vlist",style:{height:"0.2861em"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,a.jsx)(e.span,{className:"mrel",children:"="}),(0,a.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,a.jsxs)(e.span,{className:"base",children:[(0,a.jsx)(e.span,{className:"strut",style:{height:"0.8333em",verticalAlign:"-0.15em"}}),(0,a.jsx)(e.span,{className:"mord",children:"0.6"}),(0,a.jsxs)(e.span,{className:"mord",children:[(0,a.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.07153em"},children:"K"}),(0,a.jsx)(e.span,{className:"msupsub",children:(0,a.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,a.jsxs)(e.span,{className:"vlist-r",children:[(0,a.jsx)(e.span,{className:"vlist",style:{height:"0.1514em"},children:(0,a.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0715em",marginRight:"0.05em"},children:[(0,a.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,a.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,a.jsx)(e.span,{className:"mord mathnormal mtight",children:"u"})})]})}),(0,a.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,a.jsx)(e.span,{className:"vlist-r",children:(0,a.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,a.jsx)(e.span,{})})})]})})]})]})]})]})}),"\n",(0,a.jsx)(e.li,{children:(0,a.jsxs)(e.span,{className:"katex",children:[(0,a.jsx)(e.span,{className:"katex-mathml",children:(0,a.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsxs)(e.mrow,{children:[(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:"K"}),(0,a.jsx)(e.mi,{children:"i"})]}),(0,a.jsx)(e.mo,{children:"="}),(0,a.jsx)(e.mn,{children:"2"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:"K"}),(0,a.jsx)(e.mi,{children:"p"})]}),(0,a.jsx)(e.mi,{mathvariant:"normal",children:"/"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:"T"}),(0,a.jsx)(e.mi,{children:"u"})]})]}),(0,a.jsx)(e.annotation,{encoding:"application/x-tex",children:"K_i = 2 K_p / T_u"})]})})}),(0,a.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,a.jsxs)(e.span,{className:"base",children:[(0,a.jsx)(e.span,{className:"strut",style:{height:"0.8333em",verticalAlign:"-0.15em"}}),(0,a.jsxs)(e.span,{className:"mord",children:[(0,a.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.07153em"},children:"K"}),(0,a.jsx)(e.span,{className:"msupsub",children:(0,a.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,a.jsxs)(e.span,{className:"vlist-r",children:[(0,a.jsx)(e.span,{className:"vlist",style:{height:"0.3117em"},children:(0,a.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0715em",marginRight:"0.05em"},children:[(0,a.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,a.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,a.jsx)(e.span,{className:"mord mathnormal mtight",children:"i"})})]})}),(0,a.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,a.jsx)(e.span,{className:"vlist-r",children:(0,a.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,a.jsx)(e.span,{className:"mrel",children:"="}),(0,a.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,a.jsxs)(e.span,{className:"base",children:[(0,a.jsx)(e.span,{className:"strut",style:{height:"1.0361em",verticalAlign:"-0.2861em"}}),(0,a.jsx)(e.span,{className:"mord",children:"2"}),(0,a.jsxs)(e.span,{className:"mord",children:[(0,a.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.07153em"},children:"K"}),(0,a.jsx)(e.span,{className:"msupsub",children:(0,a.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,a.jsxs)(e.span,{className:"vlist-r",children:[(0,a.jsx)(e.span,{className:"vlist",style:{height:"0.1514em"},children:(0,a.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0715em",marginRight:"0.05em"},children:[(0,a.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,a.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,a.jsx)(e.span,{className:"mord mathnormal mtight",children:"p"})})]})}),(0,a.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,a.jsx)(e.span,{className:"vlist-r",children:(0,a.jsx)(e.span,{className:"vlist",style:{height:"0.2861em"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:"mord",children:"/"}),(0,a.jsxs)(e.span,{className:"mord",children:[(0,a.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.13889em"},children:"T"}),(0,a.jsx)(e.span,{className:"msupsub",children:(0,a.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,a.jsxs)(e.span,{className:"vlist-r",children:[(0,a.jsx)(e.span,{className:"vlist",style:{height:"0.1514em"},children:(0,a.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.1389em",marginRight:"0.05em"},children:[(0,a.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,a.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,a.jsx)(e.span,{className:"mord mathnormal mtight",children:"u"})})]})}),(0,a.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,a.jsx)(e.span,{className:"vlist-r",children:(0,a.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,a.jsx)(e.span,{})})})]})})]})]})]})]})}),"\n",(0,a.jsx)(e.li,{children:(0,a.jsxs)(e.span,{className:"katex",children:[(0,a.jsx)(e.span,{className:"katex-mathml",children:(0,a.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsxs)(e.mrow,{children:[(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:"K"}),(0,a.jsx)(e.mi,{children:"d"})]}),(0,a.jsx)(e.mo,{children:"="}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:"K"}),(0,a.jsx)(e.mi,{children:"p"})]}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:"T"}),(0,a.jsx)(e.mi,{children:"u"})]}),(0,a.jsx)(e.mi,{mathvariant:"normal",children:"/"}),(0,a.jsx)(e.mn,{children:"8"})]}),(0,a.jsx)(e.annotation,{encoding:"application/x-tex",children:"K_d = K_p T_u / 8"})]})})}),(0,a.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,a.jsxs)(e.span,{className:"base",children:[(0,a.jsx)(e.span,{className:"strut",style:{height:"0.8333em",verticalAlign:"-0.15em"}}),(0,a.jsxs)(e.span,{className:"mord",children:[(0,a.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.07153em"},children:"K"}),(0,a.jsx)(e.span,{className:"msupsub",children:(0,a.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,a.jsxs)(e.span,{className:"vlist-r",children:[(0,a.jsx)(e.span,{className:"vlist",style:{height:"0.3361em"},children:(0,a.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0715em",marginRight:"0.05em"},children:[(0,a.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,a.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,a.jsx)(e.span,{className:"mord mathnormal mtight",children:"d"})})]})}),(0,a.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,a.jsx)(e.span,{className:"vlist-r",children:(0,a.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,a.jsx)(e.span,{className:"mrel",children:"="}),(0,a.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,a.jsxs)(e.span,{className:"base",children:[(0,a.jsx)(e.span,{className:"strut",style:{height:"1.0361em",verticalAlign:"-0.2861em"}}),(0,a.jsxs)(e.span,{className:"mord",children:[(0,a.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.07153em"},children:"K"}),(0,a.jsx)(e.span,{className:"msupsub",children:(0,a.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,a.jsxs)(e.span,{className:"vlist-r",children:[(0,a.jsx)(e.span,{className:"vlist",style:{height:"0.1514em"},children:(0,a.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0715em",marginRight:"0.05em"},children:[(0,a.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,a.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,a.jsx)(e.span,{className:"mord mathnormal mtight",children:"p"})})]})}),(0,a.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,a.jsx)(e.span,{className:"vlist-r",children:(0,a.jsx)(e.span,{className:"vlist",style:{height:"0.2861em"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsxs)(e.span,{className:"mord",children:[(0,a.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.13889em"},children:"T"}),(0,a.jsx)(e.span,{className:"msupsub",children:(0,a.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,a.jsxs)(e.span,{className:"vlist-r",children:[(0,a.jsx)(e.span,{className:"vlist",style:{height:"0.1514em"},children:(0,a.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.1389em",marginRight:"0.05em"},children:[(0,a.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,a.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,a.jsx)(e.span,{className:"mord mathnormal mtight",children:"u"})})]})}),(0,a.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,a.jsx)(e.span,{className:"vlist-r",children:(0,a.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:"mord",children:"/8"})]})]})]})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(e.p,{children:[(0,a.jsx)(e.strong,{children:"Implementation"}),":"]}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-python",children:'class JointPIDController:\r\n    def __init__(self, kp, ki, kd, dt=0.001):\r\n        self.kp = kp\r\n        self.ki = ki\r\n        self.kd = kd\r\n        self.dt = dt\r\n\r\n        self.error_integral = 0\r\n        self.prev_error = 0\r\n\r\n    def compute(self, q_des, q_actual, q_dot_actual):\r\n        """\r\n        Compute PID control\r\n\r\n        Args:\r\n            q_des: Desired joint position\r\n            q_actual: Actual joint position\r\n            q_dot_actual: Actual joint velocity\r\n\r\n        Returns:\r\n            tau: Joint torque command\r\n        """\r\n        # Error\r\n        error = q_des - q_actual\r\n\r\n        # Integral (with anti-windup)\r\n        self.error_integral += error * self.dt\r\n        self.error_integral = np.clip(self.error_integral, -10, 10)\r\n\r\n        # Derivative (from velocity feedback)\r\n        error_derivative = -q_dot_actual\r\n\r\n        # PID law\r\n        tau = self.kp * error + self.ki * self.error_integral + self.kd * error_derivative\r\n\r\n        self.prev_error = error\r\n        return tau\n'})}),"\n",(0,a.jsx)(e.h3,{id:"impedance-control",children:"Impedance Control"}),"\n",(0,a.jsxs)(e.p,{children:[(0,a.jsx)(e.strong,{children:"Compliant interaction"})," with environment:"]}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-python",children:'class ImpedanceController:\r\n    def __init__(self, K_stiffness, D_damping):\r\n        """\r\n        Args:\r\n            K_stiffness: (6, 6) stiffness matrix (task space)\r\n            D_damping: (6, 6) damping matrix\r\n        """\r\n        self.K = K_stiffness\r\n        self.D = D_damping\r\n\r\n    def compute(self, x_des, x_actual, x_dot_actual, f_external):\r\n        """\r\n        Compute impedance control force\r\n\r\n        Args:\r\n            x_des: Desired end-effector pose (6,)\r\n            x_actual: Actual pose (6,)\r\n            x_dot_actual: Actual velocity (6,)\r\n            f_external: External force (6,)\r\n\r\n        Returns:\r\n            f_cmd: Commanded force (6,)\r\n        """\r\n        # Position error\r\n        x_error = x_des - x_actual\r\n\r\n        # Impedance law: F = K*(x_des - x) - D*\u1e8b\r\n        f_cmd = self.K @ x_error - self.D @ x_dot_actual\r\n\r\n        # Add external force compensation\r\n        f_cmd += f_external\r\n\r\n        return f_cmd\r\n\r\n    def joint_torques(self, f_cmd, J):\r\n        """\r\n        Convert task-space force to joint torques\r\n\r\n        Args:\r\n            f_cmd: Task-space force (6,)\r\n            J: Jacobian (6, n)\r\n\r\n        Returns:\r\n            tau: Joint torques (n,)\r\n        """\r\n        return J.T @ f_cmd\n'})}),"\n",(0,a.jsx)(e.h2,{id:"exercises",children:"Exercises"}),"\n",(0,a.jsxs)(e.p,{children:[(0,a.jsx)(e.strong,{children:"Exercise 3.1"}),": Whole-Body Controller Implementation"]}),"\n",(0,a.jsxs)(e.ul,{children:["\n",(0,a.jsx)(e.li,{children:"Implement QP-based whole-body controller in simulation"}),"\n",(0,a.jsx)(e.li,{children:"Test with dual-arm reaching task (2 end-effectors)"}),"\n",(0,a.jsx)(e.li,{children:"Compare prioritized vs weighted multi-task approach"}),"\n"]}),"\n",(0,a.jsxs)(e.p,{children:[(0,a.jsx)(e.strong,{children:"Exercise 3.2"}),": ZMP-Based Walking"]}),"\n",(0,a.jsxs)(e.ul,{children:["\n",(0,a.jsx)(e.li,{children:"Generate ZMP trajectory for 5-step walking pattern"}),"\n",(0,a.jsx)(e.li,{children:"Simulate in Isaac Sim or MuJoCo"}),"\n",(0,a.jsx)(e.li,{children:"Measure stability margin (distance from ZMP to support polygon edge)"}),"\n"]}),"\n",(0,a.jsxs)(e.p,{children:[(0,a.jsx)(e.strong,{children:"Exercise 3.3"}),": PID Tuning"]}),"\n",(0,a.jsxs)(e.ul,{children:["\n",(0,a.jsx)(e.li,{children:"Tune PID gains for a single joint (elbow or knee)"}),"\n",(0,a.jsx)(e.li,{children:"Use Ziegler-Nichols method or manual tuning"}),"\n",(0,a.jsx)(e.li,{children:"Plot step response and measure: rise time, overshoot, settling time"}),"\n"]}),"\n",(0,a.jsxs)(e.p,{children:[(0,a.jsx)(e.strong,{children:"Exercise 3.4"}),": Impedance Control"]}),"\n",(0,a.jsxs)(e.ul,{children:["\n",(0,a.jsx)(e.li,{children:"Implement impedance controller for arm"}),"\n",(0,a.jsx)(e.li,{children:"Test compliance by pushing end-effector in simulation"}),"\n",(0,a.jsx)(e.li,{children:"Measure interaction force and position deviation"}),"\n"]}),"\n",(0,a.jsx)(e.h2,{id:"summary",children:"Summary"}),"\n",(0,a.jsxs)(e.p,{children:[(0,a.jsx)(e.strong,{children:"Whole-Body Control"}),": QP optimization for multi-task coordination (end-effector + CoM tracking)\r\n",(0,a.jsx)(e.strong,{children:"Balance Control"}),": ZMP for stability verification, MPC for predictive balance\r\n",(0,a.jsx)(e.strong,{children:"Joint Control"}),": PID for tracking, impedance for compliant interaction"]}),"\n",(0,a.jsxs)(e.p,{children:[(0,a.jsx)(e.strong,{children:"Next"}),": Chapter 4 covers VLA autonomy integration and real-world deployment."]})]})}function h(s={}){const{wrapper:e}={...(0,l.R)(),...s.components};return e?(0,a.jsx)(e,{...s,children:(0,a.jsx)(m,{...s})}):m(s)}},28453:(s,e,n)=>{n.d(e,{R:()=>i,x:()=>t});var r=n(96540);const a={},l=r.createContext(a);function i(s){const e=r.useContext(l);return r.useMemo(function(){return"function"==typeof s?s(e):{...e,...s}},[e,s])}function t(s){let e;return e=s.disableParentContext?"function"==typeof s.components?s.components(a):s.components||a:i(s.components),r.createElement(l.Provider,{value:e},s.children)}}}]);