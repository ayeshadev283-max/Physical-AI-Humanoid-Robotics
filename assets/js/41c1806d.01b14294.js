"use strict";(globalThis.webpackChunkphysical_ai_humanoid_robotics_book=globalThis.webpackChunkphysical_ai_humanoid_robotics_book||[]).push([[5768],{2201:(e,t,a)=>{a.r(t),a.d(t,{default:()=>N});var s=a(96540),n=a(62765),i=a(94335),r=a(9012);const o=new class{constructor(e){const t=e||(0,r.e)();this.client=i.A.create({baseURL:t,timeout:3e4,headers:{"Content-Type":"application/json"}})}async getAnalyticsSummary(e){try{return(await this.client.get("/v1/analytics/summary",{params:{start_date:e.start_date,end_date:e.end_date,book_id:e.book_id}})).data}catch(t){if(i.A.isAxiosError(t)&&t.response){const e=t.response.data?.detail||"Failed to fetch analytics";throw new Error(e)}throw new Error("Network error. Please check your connection and try again.")}}formatDateForAPI(e){return e.toISOString()}getDefaultDateRange(){const e=new Date,t=new Date;return t.setDate(t.getDate()-7),{start_date:this.formatDateForAPI(t),end_date:this.formatDateForAPI(e)}}getDateRangeForLastNDays(e){const t=new Date,a=new Date;return a.setDate(a.getDate()-e),{start_date:this.formatDateForAPI(a),end_date:this.formatDateForAPI(t)}}},c=new Map,l=3e5;function d(e){return`${e.start_date}|${e.end_date}|${e.book_id||"all"}`}function u(e={}){const{initialDateRange:t=o.getDefaultDateRange(),bookId:a,autoFetch:n=!0}=e,[i,r]=(0,s.useState)(null),[u,m]=(0,s.useState)(!1),[h,p]=(0,s.useState)(null),[x,_]=(0,s.useState)(t),[j,f]=(0,s.useState)(a),b=(0,s.useCallback)(async()=>{const e={start_date:x.start_date,end_date:x.end_date,book_id:j},t=function(e){const t=d(e),a=c.get(t);return a?Date.now()-a.timestamp>l?(c.delete(t),null):a.data:null}(e);if(t)return r(t),void p(null);m(!0),p(null);try{const t=await o.getAnalyticsSummary(e);r(t),function(e,t){const a=d(e);if(c.set(a,{data:t,timestamp:Date.now()}),c.size>50){const e=c.keys().next().value;c.delete(e)}}(e,t)}catch(a){const e=a instanceof Error?a.message:"Failed to fetch analytics";p(e),r(null)}finally{m(!1)}},[x,j]);return(0,s.useEffect)(()=>{n&&b()},[b,n]),{summary:i,loading:u,error:h,dateRange:x,setDateRange:_,refetch:b,setBookId:f}}const m={card:"card_tW6p",header:"header_aKR2",icon:"icon_bf6f",title:"title_zLM7",body:"body_f2e8",value:"value_xTRu",trend:"trend_pIJT",trendPositive:"trendPositive_ovCa",trendNegative:"trendNegative_JwQU",trendIcon:"trendIcon_QPEG",trendValue:"trendValue_Ziu5",description:"description_d_0J"};var h=a(74848);function p({title:e,value:t,format:a="number",icon:s,description:n,trend:i}){const r=function(e,t){if("string"==typeof e)return e;switch(t){case"number":return e.toLocaleString();case"time":const t=Math.floor(e/60),a=e%60;return t>0?`${t}h ${a}m`:`${a} min`;case"percentage":return`${e.toFixed(1)}%`;case"latency":return e>=1e3?`${(e/1e3).toFixed(2)}s`:`${e}ms`;default:return String(e)}}(t,a);return(0,h.jsxs)("div",{className:m.card,children:[(0,h.jsxs)("div",{className:m.header,children:[s&&(0,h.jsx)("span",{className:m.icon,children:s}),(0,h.jsx)("h3",{className:m.title,children:e})]}),(0,h.jsxs)("div",{className:m.body,children:[(0,h.jsx)("div",{className:m.value,children:r}),i&&(0,h.jsxs)("div",{className:`${m.trend} ${i.isPositive?m.trendPositive:m.trendNegative}`,children:[(0,h.jsx)("span",{className:m.trendIcon,children:i.isPositive?"\u2191":"\u2193"}),(0,h.jsxs)("span",{className:m.trendValue,children:[Math.abs(i.value),"%"]})]})]}),n&&(0,h.jsx)("p",{className:m.description,children:n})]})}const x={container:"container_futR",table:"table_wkjT",rankColumn:"rankColumn_Ty5R",topicColumn:"topicColumn_XgEs",countColumn:"countColumn_q1vx",percentColumn:"percentColumn_l42w",sortable:"sortable_nY50",topicText:"topicText_bcOg",countBadge:"countBadge_QMOf",percentText:"percentText_yQTR",emptyState:"emptyState_MUYb"};function _({topics:e,totalQueries:t}){const[a,n]=(0,s.useState)("count"),[i,r]=(0,s.useState)("desc"),o=e=>{e===a?r("asc"===i?"desc":"asc"):(n(e),r("count"===e?"desc":"asc"))},c=(0,s.useMemo)(()=>[...e].sort((e,t)=>{let s=0;return s="topic"===a?e.topic.localeCompare(t.topic):e.count-t.count,"asc"===i?s:-s}),[e,a,i]),l=e=>e!==a?"\u21c5":"asc"===i?"\u2191":"\u2193";return 0===e.length?(0,h.jsx)("div",{className:x.emptyState,children:(0,h.jsx)("p",{children:"No topic data available for this period."})}):(0,h.jsx)("div",{className:x.container,children:(0,h.jsxs)("table",{className:x.table,children:[(0,h.jsx)("thead",{children:(0,h.jsxs)("tr",{children:[(0,h.jsx)("th",{className:x.rankColumn,children:"#"}),(0,h.jsxs)("th",{className:`${x.topicColumn} ${x.sortable}`,onClick:()=>o("topic"),children:["Topic ",l("topic")]}),(0,h.jsxs)("th",{className:`${x.countColumn} ${x.sortable}`,onClick:()=>o("count"),children:["Count ",l("count")]}),(0,h.jsx)("th",{className:x.percentColumn,children:"%"})]})}),(0,h.jsx)("tbody",{children:c.map((e,a)=>{const s=t>0?(e.count/t*100).toFixed(1):"0.0";return(0,h.jsxs)("tr",{children:[(0,h.jsx)("td",{className:x.rankColumn,children:a+1}),(0,h.jsx)("td",{className:x.topicColumn,children:(0,h.jsx)("span",{className:x.topicText,children:e.topic})}),(0,h.jsx)("td",{className:x.countColumn,children:(0,h.jsx)("span",{className:x.countBadge,children:e.count})}),(0,h.jsx)("td",{className:x.percentColumn,children:(0,h.jsxs)("span",{className:x.percentText,children:[s,"%"]})})]},`${e.topic}-${a}`)})})]})})}const j={container:"container_kX9H",label:"label_QDdX",presets:"presets_mgQ3",presetsButtons:"presetsButtons_tiQE",presetButton:"presetButton_YvJg",custom:"custom_Q9uY",customInputs:"customInputs_l1uD",inputGroup:"inputGroup_qTmD",inputLabel:"inputLabel_kbA_",dateInput:"dateInput_CYft",applyButton:"applyButton_w7pw",error:"error_Ezn1"},f=[{label:"Last 7 days",days:7},{label:"Last 30 days",days:30},{label:"Last 90 days",days:90}];function b({startDate:e,endDate:t,onDateRangeChange:a}){const[n,i]=(0,s.useState)(d(e)),[r,o]=(0,s.useState)(d(t)),[c,l]=(0,s.useState)(null);function d(e){return e.split("T")[0]}function u(e){return new Date(e+"T00:00:00Z").toISOString()}return(0,h.jsxs)("div",{className:j.container,children:[(0,h.jsxs)("div",{className:j.presets,children:[(0,h.jsx)("label",{className:j.label,children:"Quick Select:"}),(0,h.jsx)("div",{className:j.presetsButtons,children:f.map(e=>(0,h.jsx)("button",{type:"button",className:j.presetButton,onClick:()=>(e=>{const t=new Date,s=new Date;s.setDate(s.getDate()-e.days);const n={start_date:s.toISOString(),end_date:t.toISOString()};i(d(n.start_date)),o(d(n.end_date)),l(null),a(n)})(e),children:e.label},e.days))})]}),(0,h.jsxs)("div",{className:j.custom,children:[(0,h.jsx)("label",{className:j.label,children:"Custom Range:"}),(0,h.jsxs)("div",{className:j.customInputs,children:[(0,h.jsxs)("div",{className:j.inputGroup,children:[(0,h.jsx)("label",{htmlFor:"start-date",className:j.inputLabel,children:"Start Date"}),(0,h.jsx)("input",{id:"start-date",type:"date",value:n,onChange:e=>i(e.target.value),className:j.dateInput,max:d((new Date).toISOString())})]}),(0,h.jsxs)("div",{className:j.inputGroup,children:[(0,h.jsx)("label",{htmlFor:"end-date",className:j.inputLabel,children:"End Date"}),(0,h.jsx)("input",{id:"end-date",type:"date",value:r,onChange:e=>o(e.target.value),className:j.dateInput,max:d((new Date).toISOString())})]}),(0,h.jsx)("button",{type:"button",className:j.applyButton,onClick:()=>{const e=new Date(n),t=new Date(r);if(isNaN(e.getTime())||isNaN(t.getTime()))return void l("Invalid date format");if(t<=e)return void l("End date must be after start date");const s=new Date;e>s||t>s?l("Dates cannot be in the future"):(l(null),a({start_date:u(n),end_date:u(r)}))},children:"Apply"})]}),c&&(0,h.jsx)("p",{className:j.error,children:c})]})]})}const g={container:"container_w4FP",header:"header_geaa",subtitle:"subtitle_mxYM",section:"section_A1ab",sectionTitle:"sectionTitle_ih5Y",metricsGrid:"metricsGrid_XQtO",loading:"loading_kGOl",spinner:"spinner_Fdk3",spin:"spin_GzlQ",error:"error_nVb8",retryButton:"retryButton_iL5M",emptyState:"emptyState_iF2D",footer:"footer_RPrO",footerText:"footerText_drwY"};function y({bookId:e}){const{summary:t,loading:a,error:s,dateRange:n,setDateRange:i,refetch:r}=u({bookId:e,autoFetch:!0});return s?(0,h.jsx)("div",{className:g.container,children:(0,h.jsxs)("div",{className:g.error,children:[(0,h.jsx)("h2",{children:"Error Loading Analytics"}),(0,h.jsx)("p",{children:s}),(0,h.jsx)("button",{onClick:r,className:g.retryButton,children:"Retry"})]})}):(0,h.jsxs)("div",{className:g.container,children:[(0,h.jsxs)("header",{className:g.header,children:[(0,h.jsx)("h1",{children:"Chatbot Usage Analytics"}),(0,h.jsx)("p",{className:g.subtitle,children:"Monitor chatbot performance, user engagement, and teacher time savings"})]}),(0,h.jsx)(b,{startDate:n.start_date,endDate:n.end_date,onDateRangeChange:e=>{i(e)}}),a?(0,h.jsxs)("div",{className:g.loading,children:[(0,h.jsx)("div",{className:g.spinner}),(0,h.jsx)("p",{children:"Loading analytics..."})]}):t?(0,h.jsxs)(h.Fragment,{children:[(0,h.jsxs)("section",{className:g.section,children:[(0,h.jsx)("h2",{className:g.sectionTitle,children:"Key Metrics"}),(0,h.jsxs)("div",{className:g.metricsGrid,children:[(0,h.jsx)(p,{title:"Total Queries",value:t.total_queries,format:"number",icon:"\ud83d\udcac",description:"Total number of student questions"}),(0,h.jsx)(p,{title:"Unique Users",value:t.unique_users,format:"number",icon:"\ud83d\udc65",description:"Students who used the chatbot"}),(0,h.jsx)(p,{title:"Teacher Time Saved",value:t.teacher_time_saved_minutes,format:"time",icon:"\u23f1\ufe0f",description:"Estimated time saved (2.5 min per query)"}),(0,h.jsx)(p,{title:"Feedback Rate",value:t.feedback_rate,format:"percentage",icon:"\ud83d\udcca",description:"Percentage of queries with feedback"})]})]}),(0,h.jsxs)("section",{className:g.section,children:[(0,h.jsx)("h2",{className:g.sectionTitle,children:"Quality Metrics"}),(0,h.jsxs)("div",{className:g.metricsGrid,children:[(0,h.jsx)(p,{title:"Average Confidence",value:(100*t.average_confidence).toFixed(1),format:"percentage",icon:"\ud83c\udfaf",description:"Average response confidence score"}),null!==t.positive_feedback_rate&&(0,h.jsx)(p,{title:"Positive Feedback",value:t.positive_feedback_rate,format:"percentage",icon:"\ud83d\udc4d",description:"Percentage of helpful ratings"})]})]}),(0,h.jsxs)("section",{className:g.section,children:[(0,h.jsx)("h2",{className:g.sectionTitle,children:"Response Latency"}),(0,h.jsxs)("div",{className:g.metricsGrid,children:[(0,h.jsx)(p,{title:"Median (p50)",value:t.latency_p50,format:"latency",icon:"\ud83d\udcc8",description:"50% of responses faster than this"}),(0,h.jsx)(p,{title:"95th Percentile",value:t.latency_p95,format:"latency",icon:"\ud83d\udcc8",description:"95% of responses faster than this"}),(0,h.jsx)(p,{title:"99th Percentile",value:t.latency_p99,format:"latency",icon:"\ud83d\udcc8",description:"99% of responses faster than this"})]})]}),(0,h.jsxs)("section",{className:g.section,children:[(0,h.jsx)("h2",{className:g.sectionTitle,children:"Top Question Topics"}),(0,h.jsx)(_,{topics:t.top_topics,totalQueries:t.total_queries})]}),(0,h.jsxs)("footer",{className:g.footer,children:[(0,h.jsxs)("p",{className:g.footerText,children:["Data period: ",new Date(t.start_date).toLocaleDateString()," -"," ",new Date(t.end_date).toLocaleDateString()]}),t.book_id&&(0,h.jsxs)("p",{className:g.footerText,children:["Book: ",t.book_id]})]})]}):(0,h.jsx)("div",{className:g.emptyState,children:(0,h.jsx)("p",{children:"No data available for the selected period."})})]})}function N(){return(0,h.jsx)(n.A,{title:"Analytics Dashboard",description:"Chatbot usage analytics and teacher workload insights",children:(0,h.jsx)("main",{children:(0,h.jsx)(y,{bookId:"physical-ai-robotics"})})})}},9012:(e,t,a)=>{a.d(t,{e:()=>i});const s="https://ayeshassdev-aibook.hf.space",n="http://localhost:8000";function i(){return"undefined"!=typeof window&&"localhost"===window.location.hostname?n:s}}}]);