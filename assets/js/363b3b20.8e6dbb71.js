"use strict";(globalThis.webpackChunkphysical_ai_humanoid_robotics_book=globalThis.webpackChunkphysical_ai_humanoid_robotics_book||[]).push([[4446],{28453:(e,n,r)=>{r.d(n,{R:()=>t,x:()=>l});var s=r(96540);const i={},o=s.createContext(i);function t(e){const n=s.useContext(o);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:t(e.components),s.createElement(o.Provider,{value:n},e.children)}},81532:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>a,contentTitle:()=>l,default:()=>h,frontMatter:()=>t,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"chapters/module-2-digital-twin/ros2-integration","title":"Chapter 4: ROS 2 Integration","description":"Gazebo-ROS 2 bridge, Unity-ROS 2 integration, and multi-simulator workflows","source":"@site/docs/chapters/module-2-digital-twin/04-ros2-integration.md","sourceDirName":"chapters/module-2-digital-twin","slug":"/chapters/module-2-digital-twin/ros2-integration","permalink":"/Physical-AI-Humanoid-Robotics/chapters/module-2-digital-twin/ros2-integration","draft":false,"unlisted":false,"editUrl":"https://github.com/ayeshadev283-max/Physical-AI-Humanoid-Robotics/tree/main/docs/chapters/module-2-digital-twin/04-ros2-integration.md","tags":[{"inline":true,"label":"ros2","permalink":"/Physical-AI-Humanoid-Robotics/tags/ros-2"},{"inline":true,"label":"gazebo","permalink":"/Physical-AI-Humanoid-Robotics/tags/gazebo"},{"inline":true,"label":"unity","permalink":"/Physical-AI-Humanoid-Robotics/tags/unity"},{"inline":true,"label":"bridge","permalink":"/Physical-AI-Humanoid-Robotics/tags/bridge"},{"inline":true,"label":"integration","permalink":"/Physical-AI-Humanoid-Robotics/tags/integration"},{"inline":true,"label":"multi-simulator","permalink":"/Physical-AI-Humanoid-Robotics/tags/multi-simulator"}],"version":"current","sidebarPosition":4,"frontMatter":{"sidebar_position":4,"title":"Chapter 4: ROS 2 Integration","description":"Gazebo-ROS 2 bridge, Unity-ROS 2 integration, and multi-simulator workflows","tags":["ros2","gazebo","unity","bridge","integration","multi-simulator"]},"sidebar":"bookSidebar","previous":{"title":"Chapter 3: Unity Animation","permalink":"/Physical-AI-Humanoid-Robotics/chapters/module-2-digital-twin/unity-animation"},"next":{"title":"Module 3: NVIDIA Isaac","permalink":"/Physical-AI-Humanoid-Robotics/module-3-isaac"}}');var i=r(74848),o=r(28453);const t={sidebar_position:4,title:"Chapter 4: ROS 2 Integration",description:"Gazebo-ROS 2 bridge, Unity-ROS 2 integration, and multi-simulator workflows",tags:["ros2","gazebo","unity","bridge","integration","multi-simulator"]},l="Chapter 4: ROS 2 Integration",a={},c=[{value:"Learning Objectives",id:"learning-objectives",level:2},{value:"4.1 Gazebo-ROS 2 Bridge",id:"41-gazebo-ros-2-bridge",level:2},{value:"Architecture",id:"architecture",level:3},{value:"Message Translation",id:"message-translation",level:3},{value:"Clock Synchronization",id:"clock-synchronization",level:3},{value:"Plugin-Based Integration",id:"plugin-based-integration",level:3},{value:"Debugging Bridge",id:"debugging-bridge",level:3},{value:"4.2 Unity-ROS 2 Integration",id:"42-unity-ros-2-integration",level:2},{value:"ROS-TCP-Connector Architecture",id:"ros-tcp-connector-architecture",level:3},{value:"Setup",id:"setup",level:3},{value:"Message Generation",id:"message-generation",level:3},{value:"Publishing from Unity",id:"publishing-from-unity",level:3},{value:"Subscribing in Unity",id:"subscribing-in-unity",level:3},{value:"Service Calls",id:"service-calls",level:3},{value:"4.3 Multi-Simulator Workflows",id:"43-multi-simulator-workflows",level:2},{value:"Hybrid Simulation",id:"hybrid-simulation",level:3},{value:"Parallel Simulations",id:"parallel-simulations",level:3},{value:"Sequential Workflow",id:"sequential-workflow",level:3},{value:"Cross-Simulator Verification",id:"cross-simulator-verification",level:3},{value:"Best Practices",id:"best-practices",level:3},{value:"Summary",id:"summary",level:2},{value:"Exercises",id:"exercises",level:2}];function d(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",mermaid:"mermaid",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"chapter-4-ros-2-integration",children:"Chapter 4: ROS 2 Integration"})}),"\n",(0,i.jsx)(n.h2,{id:"learning-objectives",children:"Learning Objectives"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Configure Gazebo-ROS 2 bridge for seamless message passing"}),"\n",(0,i.jsx)(n.li,{children:"Integrate Unity with ROS 2 using ROS-TCP-Connector"}),"\n",(0,i.jsx)(n.li,{children:"Design multi-simulator workflows combining Gazebo and Unity"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"41-gazebo-ros-2-bridge",children:"4.1 Gazebo-ROS 2 Bridge"}),"\n",(0,i.jsx)(n.h3,{id:"architecture",children:"Architecture"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"ros_gz"})," (formerly ros_ign): Bridge between Gazebo and ROS 2"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Components"}),":"]}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"ros_gz_bridge"}),": Message translator (Gazebo \u2194 ROS 2)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"ros_gz_sim"}),": Launch Gazebo from ROS 2"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"ros_gz_image"}),": Image transport optimization"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"message-translation",children:"Message Translation"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Gazebo Topics"})," use Protobuf messages (e.g., ",(0,i.jsx)(n.code,{children:"gz.msgs.Twist"}),")\r\n",(0,i.jsx)(n.strong,{children:"ROS 2 Topics"})," use ROS messages (e.g., ",(0,i.jsx)(n.code,{children:"geometry_msgs/Twist"}),")"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Bridge"}),": Converts between formats automatically"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Example Bridge Configuration"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'# bridge_config.yaml\r\n- ros_topic_name: "/cmd_vel"\r\n  gz_topic_name: "/model/robot/cmd_vel"\r\n  ros_type_name: "geometry_msgs/msg/Twist"\r\n  gz_type_name: "gz.msgs.Twist"\r\n  direction: ROS_TO_GZ\r\n\r\n- ros_topic_name: "/scan"\r\n  gz_topic_name: "/world/warehouse/model/robot/link/lidar_link/sensor/lidar/scan"\r\n  ros_type_name: "sensor_msgs/msg/LaserScan"\r\n  gz_type_name: "gz.msgs.LaserScan"\r\n  direction: GZ_TO_ROS\r\n\r\n- ros_topic_name: "/camera/image"\r\n  gz_topic_name: "/camera"\r\n  ros_type_name: "sensor_msgs/msg/Image"\r\n  gz_type_name: "gz.msgs.Image"\r\n  direction: GZ_TO_ROS\n'})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Launch Bridge"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"ros2 run ros_gz_bridge parameter_bridge --ros-args -p config_file:=bridge_config.yaml\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Bidirectional"})," (ROS \u2194 Gazebo):"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"direction: BIDIRECTIONAL\n"})}),"\n",(0,i.jsx)(n.h3,{id:"clock-synchronization",children:"Clock Synchronization"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Problem"}),": Simulation time \u2260 wall-clock time (pause, slow-motion, fast-forward)"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Solution"}),": ",(0,i.jsx)(n.code,{children:"/clock"})," topic with ",(0,i.jsx)(n.code,{children:"use_sim_time:=true"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Gazebo publishes clock"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-xml",children:'\x3c!-- In world SDF --\x3e\r\n<plugin filename="libgz_ros2_control-system.so" name="gz_ros2_control">\r\n  <ros>\r\n    <namespace>/robot</namespace>\r\n    <argument>--ros-args</argument>\r\n    <argument>-p use_sim_time:=true</argument>\r\n  </ros>\r\n</plugin>\n'})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"ROS 2 nodes use sim time"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"ros2 run my_package my_node --ros-args -p use_sim_time:=true\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Bridge automatically forwards /clock"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"ros2 run ros_gz_bridge parameter_bridge /clock@rosgraph_msgs/msg/Clock[gz.msgs.Clock\n"})}),"\n",(0,i.jsx)(n.h3,{id:"plugin-based-integration",children:"Plugin-Based Integration"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Alternative"}),": Gazebo ROS 2 plugins (no bridge needed)"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Camera Plugin"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-xml",children:'<sensor name="camera" type="camera">\r\n  <plugin filename="libgazebo_ros_camera.so" name="camera_driver">\r\n    <ros>\r\n      <namespace>/robot</namespace>\r\n      <remapping>image_raw:=camera/image</remapping>\r\n      <remapping>camera_info:=camera/info</remapping>\r\n    </ros>\r\n    <update_rate>30</update_rate>\r\n  </plugin>\r\n</sensor>\n'})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Advantages"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"No separate bridge process"}),"\n",(0,i.jsx)(n.li,{children:"Lower latency (direct ROS 2 publishing)"}),"\n",(0,i.jsx)(n.li,{children:"Simpler launch files"}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Disadvantages"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Plugin must exist for each sensor type"}),"\n",(0,i.jsx)(n.li,{children:"Less flexible than bridge (bridge can map any topic)"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"debugging-bridge",children:"Debugging Bridge"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# List Gazebo topics\r\ngz topic -l\r\n\r\n# Echo Gazebo topic\r\ngz topic -e -t /model/robot/cmd_vel\r\n\r\n# Check ROS 2 topics\r\nros2 topic list\r\n\r\n# Monitor data flow\r\nros2 topic echo /cmd_vel\r\ngz topic -e -t /model/robot/cmd_vel\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Common Issues"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Type mismatch"}),": ROS and Gazebo message types don't align"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Topic name errors"}),": Check exact topic names (case-sensitive)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Clock not synced"}),": Nodes not using ",(0,i.jsx)(n.code,{children:"use_sim_time:=true"})]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"42-unity-ros-2-integration",children:"4.2 Unity-ROS 2 Integration"}),"\n",(0,i.jsx)(n.h3,{id:"ros-tcp-connector-architecture",children:"ROS-TCP-Connector Architecture"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Components"}),":"]}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Unity Package"}),": ",(0,i.jsx)(n.code,{children:"com.unity.robotics.ros-tcp-connector"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"ROS 2 Package"}),": ",(0,i.jsx)(n.code,{children:"ros_tcp_endpoint"})]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Communication"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"Unity (C#) \u2190\u2192 TCP Socket \u2190\u2192 ROS 2 (Python/C++)\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Advantages"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"No native ROS 2 dependency (Unity runs standalone)"}),"\n",(0,i.jsx)(n.li,{children:"Cross-platform (Windows, macOS, Linux, mobile)"}),"\n",(0,i.jsx)(n.li,{children:"Firewall-friendly (single TCP port)"}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Disadvantages"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Extra latency (TCP serialization)"}),"\n",(0,i.jsx)(n.li,{children:"Not real-time (best-effort delivery)"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"setup",children:"Setup"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Unity Side"}),":"]}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["Install package: Window \u2192 Package Manager \u2192 Add by Git URL: ",(0,i.jsx)(n.code,{children:"https://github.com/Unity-Technologies/ROS-TCP-Connector.git?path=/com.unity.robotics.ros-tcp-connector"})]}),"\n",(0,i.jsxs)(n.li,{children:["Configure: Robotics \u2192 ROS Settings","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["ROS IP Address: ",(0,i.jsx)(n.code,{children:"127.0.0.1"})," (localhost) or remote IP"]}),"\n",(0,i.jsxs)(n.li,{children:["ROS Port: ",(0,i.jsx)(n.code,{children:"10000"})," (default)"]}),"\n",(0,i.jsx)(n.li,{children:"Protocol: ROS 2"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"ROS 2 Side"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"sudo apt install ros-humble-ros-tcp-endpoint\r\nsource /opt/ros/humble/setup.bash\r\nros2 run ros_tcp_endpoint default_server_endpoint --ros-args -p ROS_IP:=0.0.0.0\n"})}),"\n",(0,i.jsx)(n.h3,{id:"message-generation",children:"Message Generation"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Auto-generate C# classes from ROS .msg files"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# In ROS 2 package\r\ncd ~/ros2_ws/src/my_msgs\r\nros2 run ros_tcp_endpoint msg_srv_gen.py --package my_msgs --output-dir ~/unity_project/Assets/RosMessages\r\n\r\n# Generates: Assets/RosMessages/my_msgs/msg/MyCustomMsg.cs\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Import in Unity"}),": Assets auto-refresh, C# classes ready to use"]}),"\n",(0,i.jsx)(n.h3,{id:"publishing-from-unity",children:"Publishing from Unity"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:'using Unity.Robotics.ROSTCPConnector;\r\nusing RosMessageTypes.Geometry;\r\n\r\npublic class VelocityPublisher : MonoBehaviour\r\n{\r\n    ROSConnection ros;\r\n    public float publishRate = 10f;  // Hz\r\n    float timer = 0f;\r\n\r\n    void Start()\r\n    {\r\n        ros = ROSConnection.GetOrCreateInstance();\r\n        ros.RegisterPublisher<TwistMsg>("cmd_vel");\r\n    }\r\n\r\n    void Update()\r\n    {\r\n        timer += Time.deltaTime;\r\n        if (timer > 1f / publishRate)\r\n        {\r\n            var msg = new TwistMsg\r\n            {\r\n                linear = new Vector3Msg { x = 1.0, y = 0.0, z = 0.0 },\r\n                angular = new Vector3Msg { x = 0.0, y = 0.0, z = 0.5 }\r\n            };\r\n            ros.Publish("cmd_vel", msg);\r\n            timer = 0f;\r\n        }\r\n    }\r\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"subscribing-in-unity",children:"Subscribing in Unity"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:'using Unity.Robotics.ROSTCPConnector;\r\nusing RosMessageTypes.Sensor;\r\n\r\npublic class LaserScanSubscriber : MonoBehaviour\r\n{\r\n    void Start()\r\n    {\r\n        ROSConnection.GetOrCreateInstance().Subscribe<LaserScanMsg>("scan", OnScanReceived);\r\n    }\r\n\r\n    void OnScanReceived(LaserScanMsg msg)\r\n    {\r\n        Debug.Log($"Received {msg.ranges.Length} laser points");\r\n\r\n        // Visualize in Unity (draw lines)\r\n        for (int i = 0; i < msg.ranges.Length; i++)\r\n        {\r\n            float angle = msg.angle_min + i * msg.angle_increment;\r\n            float range = msg.ranges[i];\r\n            Vector3 point = new Vector3(\r\n                range * Mathf.Cos(angle),\r\n                0,\r\n                range * Mathf.Sin(angle)\r\n            );\r\n            Debug.DrawRay(transform.position, point, Color.red, 0.1f);\r\n        }\r\n    }\r\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"service-calls",children:"Service Calls"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Unity Client"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:'using RosMessageTypes.Std;\r\n\r\npublic void CallService()\r\n{\r\n    var request = new TriggerRequest();\r\n    ROSConnection.GetOrCreateInstance().SendServiceMessage<TriggerResponse>(\r\n        "reset_odometry",\r\n        request,\r\n        OnServiceResponse\r\n    );\r\n}\r\n\r\nvoid OnServiceResponse(TriggerResponse response)\r\n{\r\n    if (response.success)\r\n        Debug.Log("Odometry reset successful");\r\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"ROS 2 Server"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"from std_srvs.srv import Trigger\r\n\r\ndef reset_callback(request, response):\r\n    # Reset odometry\r\n    response.success = True\r\n    response.message = \"Reset complete\"\r\n    return response\r\n\r\nnode.create_service(Trigger, 'reset_odometry', reset_callback)\n"})}),"\n",(0,i.jsx)(n.h2,{id:"43-multi-simulator-workflows",children:"4.3 Multi-Simulator Workflows"}),"\n",(0,i.jsx)(n.h3,{id:"hybrid-simulation",children:"Hybrid Simulation"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Concept"}),": Use multiple simulators for different aspects"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Example 1: Vision + Manipulation"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Unity"}),": Generate synthetic RGB-D images (domain randomization)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Gazebo"}),": Simulate grasping with DART physics"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Bridge"}),": Share object poses via ROS 2"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Workflow"}),":"]}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["Unity publishes camera images (",(0,i.jsx)(n.code,{children:"/camera/image"}),")"]}),"\n",(0,i.jsx)(n.li,{children:"Vision pipeline (ROS 2 node) detects objects"}),"\n",(0,i.jsx)(n.li,{children:"Gazebo receives object poses, simulates grasp"}),"\n",(0,i.jsx)(n.li,{children:"Grasp result sent back to Unity for visualization"}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Architecture"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510         \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510         \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\r\n\u2502  Unity    \u2502 /camera \u2502 ROS 2 Vision \u2502 /object \u2502  Gazebo   \u2502\r\n\u2502 (Visuals) \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500>\u2502   Pipeline   \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500>\u2502 (Physics) \u2502\r\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518         \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518         \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,i.jsx)(n.h3,{id:"parallel-simulations",children:"Parallel Simulations"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Use Case"}),": Distributed training (RL with 1000s of agents)"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Setup"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Launch N Unity instances on different machines"}),"\n",(0,i.jsxs)(n.li,{children:["Each publishes to unique namespace: ",(0,i.jsx)(n.code,{children:"/robot_001/cmd_vel"}),", ",(0,i.jsx)(n.code,{children:"/robot_002/cmd_vel"})]}),"\n",(0,i.jsx)(n.li,{children:"Central ROS 2 trainer subscribes to all"}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Example"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Machine 1: Launch 10 Unity instances\r\nfor i in {1..10}; do\r\n    unity-server --namespace /robot_00$i &\r\ndone\r\n\r\n# Machine 2: Python trainer\r\nros2 run my_trainer ppo_trainer --num-robots 10\n"})}),"\n",(0,i.jsx)(n.h3,{id:"sequential-workflow",children:"Sequential Workflow"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Use Case"}),": Asset pipeline (model \u2192 test \u2192 deploy)"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Stages"}),":"]}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"CAD \u2192 URDF"}),": Design in SolidWorks, export URDF"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Unity"}),": Visual validation (check mesh quality, textures)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Gazebo"}),": Physics validation (dynamics, collisions)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Real Hardware"}),": Deploy with ros2_control"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Automation"})," (CI/CD):"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"# GitHub Actions\r\n- name: Import URDF to Unity\r\n  run: unity-headless --import urdf/robot.urdf\r\n- name: Validate in Gazebo\r\n  run: ros2 launch gazebo validate_robot.launch.py\r\n- name: Build Docker image\r\n  run: docker build -t robot:latest .\n"})}),"\n",(0,i.jsx)(n.h3,{id:"cross-simulator-verification",children:"Cross-Simulator Verification"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Scenario"}),": Ensure sim-to-real consistency"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Method"}),":"]}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Run same controller in Unity, Gazebo, and hardware"}),"\n",(0,i.jsx)(n.li,{children:"Record trajectories (joint angles, velocities)"}),"\n",(0,i.jsxs)(n.li,{children:["Compare:","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Unity vs Gazebo (physics consistency)"}),"\n",(0,i.jsx)(n.li,{children:"Gazebo vs Hardware (sim-to-real gap)"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Metrics"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Mean trajectory error"}),"\n",(0,i.jsx)(n.li,{children:"Success rate (task completion)"}),"\n",(0,i.jsx)(n.li,{children:"Stability (oscillations, failures)"}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Example"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"# Log data from all sources\r\nunity_traj = load_csv('unity_trajectory.csv')\r\ngazebo_traj = load_csv('gazebo_trajectory.csv')\r\nhardware_traj = load_csv('hardware_trajectory.csv')\r\n\r\n# Compare\r\nunity_gazebo_rmse = np.sqrt(np.mean((unity_traj - gazebo_traj)**2))\r\ngazebo_hardware_rmse = np.sqrt(np.mean((gazebo_traj - hardware_traj)**2))\r\n\r\nprint(f\"Unity-Gazebo error: {unity_gazebo_rmse}\")\r\nprint(f\"Gazebo-Hardware error: {gazebo_hardware_rmse}\")\n"})}),"\n",(0,i.jsx)(n.h3,{id:"best-practices",children:"Best Practices"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Namespace isolation"}),": Use unique namespaces per simulator (",(0,i.jsx)(n.code,{children:"/unity/"}),", ",(0,i.jsx)(n.code,{children:"/gazebo/"}),")"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Clock sync"}),": All sims should publish ",(0,i.jsx)(n.code,{children:"/clock"}),", nodes use ",(0,i.jsx)(n.code,{children:"use_sim_time"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Message versioning"}),": Pin ROS message package versions (avoid drift)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Graceful fallback"}),": If Unity fails, Gazebo continues (don't tightly couple)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Logging"}),": Record all data (rosbag2) for offline analysis"]}),"\n"]}),"\n",(0,i.jsx)(n.mermaid,{value:"sequenceDiagram\r\n    participant Unity\r\n    participant TCP as ROS-TCP-Endpoint<br/>(Python/C++)\r\n    participant ROS2 as ROS 2 Network<br/>(DDS)\r\n\r\n    Note over Unity,ROS2: Initialization\r\n    Unity->>TCP: Connect (TCP Socket)\r\n    TCP->>Unity: Connection ACK\r\n\r\n    Note over Unity,ROS2: Publishing from Unity\r\n    Unity->>Unity: Create TwistMsg\r\n    Unity->>TCP: Serialize & Send (TCP)\r\n    TCP->>ROS2: Publish to /cmd_vel (DDS)\r\n\r\n    Note over Unity,ROS2: Subscribing in Unity\r\n    ROS2->>TCP: LaserScan on /scan (DDS)\r\n    TCP->>Unity: Serialize & Send (TCP)\r\n    Unity->>Unity: Deserialize LaserScanMsg\r\n    Unity->>Unity: Render in Scene\r\n\r\n    Note over Unity,ROS2: Service Call\r\n    Unity->>TCP: Service Request (Trigger)\r\n    TCP->>ROS2: Call /reset_odometry\r\n    ROS2->>TCP: Service Response\r\n    TCP->>Unity: Response (success)\r\n\r\n    Note over Unity,ROS2: Clock Sync\r\n    ROS2->>TCP: /clock tick (DDS)\r\n    TCP->>Unity: Simulation time\r\n    Unity->>Unity: Update Time.time"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Figure 4.1"}),": Unity-ROS 2 message flow via ROS-TCP-Connector. Unity communicates over TCP with the endpoint, which translates to/from ROS 2 DDS messages. Clock synchronization ensures Unity and ROS 2 nodes use the same simulation time."]}),"\n",(0,i.jsx)(n.h2,{id:"summary",children:"Summary"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Gazebo-ROS 2"}),": ",(0,i.jsx)(n.code,{children:"ros_gz_bridge"})," for message translation, plugins for direct integration\r\n",(0,i.jsx)(n.strong,{children:"Unity-ROS 2"}),": ROS-TCP-Connector over TCP, message generation from .msg files\r\n",(0,i.jsx)(n.strong,{children:"Multi-Simulator"}),": Hybrid (Unity visuals + Gazebo physics), parallel (distributed RL), sequential (asset pipeline)"]}),"\n",(0,i.jsx)(n.h2,{id:"exercises",children:"Exercises"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Exercise 4.1"}),": Configure the Gazebo-ROS 2 bridge for a robot with camera, LiDAR, and IMU. Create a bridge config YAML that:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Publishes camera images at 30 Hz"}),"\n",(0,i.jsx)(n.li,{children:"Publishes LiDAR scans at 10 Hz"}),"\n",(0,i.jsx)(n.li,{children:"Publishes IMU data at 100 Hz"}),"\n",(0,i.jsxs)(n.li,{children:["Subscribes to /cmd_vel for control\r\nVerify all topics with ",(0,i.jsx)(n.code,{children:"ros2 topic hz"}),"."]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Exercise 4.2"}),": Synchronize Gazebo and ROS 2 clocks. Launch Gazebo in slow-motion (0.5x real-time) and verify a ROS 2 node receives ",(0,i.jsx)(n.code,{children:"/clock"})," updates. Log timestamps and confirm they match simulation time, not wall-clock time."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Exercise 4.3"}),": Implement Unity-ROS 2 communication for a camera feed. Create a Unity script that:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Captures RGB images at 10 Hz"}),"\n",(0,i.jsxs)(n.li,{children:["Publishes to ",(0,i.jsx)(n.code,{children:"/unity/camera/image"})," as ",(0,i.jsx)(n.code,{children:"sensor_msgs/Image"})]}),"\n",(0,i.jsxs)(n.li,{children:["Includes correct timestamp in header\r\nSubscribe in ROS 2 and visualize with ",(0,i.jsx)(n.code,{children:"rqt_image_view"}),"."]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Exercise 4.4"}),": Design a hybrid simulation workflow. Use Unity for vision (object detection training with synthetic data) and Gazebo for manipulation (DART physics for grasping). The workflow should:"]}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Unity detects objects \u2192 publishes poses"}),"\n",(0,i.jsx)(n.li,{children:"ROS 2 node plans grasp based on poses"}),"\n",(0,i.jsx)(n.li,{children:"Gazebo executes grasp and reports success/failure"}),"\n",(0,i.jsx)(n.li,{children:"Unity updates visualization\r\nMeasure end-to-end latency from detection to grasp completion."}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Module 2 Complete!"})," Next modules cover NVIDIA Isaac (Module 3), VLA models (Module 4), and capstone project (Module 5)."]})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}}}]);