"use strict";(globalThis.webpackChunkphysical_ai_humanoid_robotics_book=globalThis.webpackChunkphysical_ai_humanoid_robotics_book||[]).push([[5768],{2201:(e,t,a)=>{a.r(t),a.d(t,{default:()=>N});var s=a(96540),n=a(62765),r=a(94335);const i=new class{constructor(e){const t=e||"undefined"!=typeof process&&process.env?.REACT_APP_API_URL||"http://localhost:8000";this.client=r.A.create({baseURL:t,timeout:3e4,headers:{"Content-Type":"application/json"}})}async getAnalyticsSummary(e){try{return(await this.client.get("/v1/analytics/summary",{params:{start_date:e.start_date,end_date:e.end_date,book_id:e.book_id}})).data}catch(t){if(r.A.isAxiosError(t)&&t.response){const e=t.response.data?.detail||"Failed to fetch analytics";throw new Error(e)}throw new Error("Network error. Please check your connection and try again.")}}formatDateForAPI(e){return e.toISOString()}getDefaultDateRange(){const e=new Date,t=new Date;return t.setDate(t.getDate()-7),{start_date:this.formatDateForAPI(t),end_date:this.formatDateForAPI(e)}}getDateRangeForLastNDays(e){const t=new Date,a=new Date;return a.setDate(a.getDate()-e),{start_date:this.formatDateForAPI(a),end_date:this.formatDateForAPI(t)}}},c=new Map,o=3e5;function l(e){return`${e.start_date}|${e.end_date}|${e.book_id||"all"}`}function d(e={}){const{initialDateRange:t=i.getDefaultDateRange(),bookId:a,autoFetch:n=!0}=e,[r,d]=(0,s.useState)(null),[u,m]=(0,s.useState)(!1),[h,p]=(0,s.useState)(null),[x,_]=(0,s.useState)(t),[j,f]=(0,s.useState)(a),b=(0,s.useCallback)(async()=>{const e={start_date:x.start_date,end_date:x.end_date,book_id:j},t=function(e){const t=l(e),a=c.get(t);return a?Date.now()-a.timestamp>o?(c.delete(t),null):a.data:null}(e);if(t)return d(t),void p(null);m(!0),p(null);try{const t=await i.getAnalyticsSummary(e);d(t),function(e,t){const a=l(e);if(c.set(a,{data:t,timestamp:Date.now()}),c.size>50){const e=c.keys().next().value;c.delete(e)}}(e,t)}catch(a){const e=a instanceof Error?a.message:"Failed to fetch analytics";p(e),d(null)}finally{m(!1)}},[x,j]);return(0,s.useEffect)(()=>{n&&b()},[b,n]),{summary:r,loading:u,error:h,dateRange:x,setDateRange:_,refetch:b,setBookId:f}}const u={card:"card_tW6p",header:"header_aKR2",icon:"icon_bf6f",title:"title_zLM7",body:"body_f2e8",value:"value_xTRu",trend:"trend_pIJT",trendPositive:"trendPositive_ovCa",trendNegative:"trendNegative_JwQU",trendIcon:"trendIcon_QPEG",trendValue:"trendValue_Ziu5",description:"description_d_0J"};var m=a(74848);function h({title:e,value:t,format:a="number",icon:s,description:n,trend:r}){const i=function(e,t){if("string"==typeof e)return e;switch(t){case"number":return e.toLocaleString();case"time":const t=Math.floor(e/60),a=e%60;return t>0?`${t}h ${a}m`:`${a} min`;case"percentage":return`${e.toFixed(1)}%`;case"latency":return e>=1e3?`${(e/1e3).toFixed(2)}s`:`${e}ms`;default:return String(e)}}(t,a);return(0,m.jsxs)("div",{className:u.card,children:[(0,m.jsxs)("div",{className:u.header,children:[s&&(0,m.jsx)("span",{className:u.icon,children:s}),(0,m.jsx)("h3",{className:u.title,children:e})]}),(0,m.jsxs)("div",{className:u.body,children:[(0,m.jsx)("div",{className:u.value,children:i}),r&&(0,m.jsxs)("div",{className:`${u.trend} ${r.isPositive?u.trendPositive:u.trendNegative}`,children:[(0,m.jsx)("span",{className:u.trendIcon,children:r.isPositive?"\u2191":"\u2193"}),(0,m.jsxs)("span",{className:u.trendValue,children:[Math.abs(r.value),"%"]})]})]}),n&&(0,m.jsx)("p",{className:u.description,children:n})]})}const p={container:"container_futR",table:"table_wkjT",rankColumn:"rankColumn_Ty5R",topicColumn:"topicColumn_XgEs",countColumn:"countColumn_q1vx",percentColumn:"percentColumn_l42w",sortable:"sortable_nY50",topicText:"topicText_bcOg",countBadge:"countBadge_QMOf",percentText:"percentText_yQTR",emptyState:"emptyState_MUYb"};function x({topics:e,totalQueries:t}){const[a,n]=(0,s.useState)("count"),[r,i]=(0,s.useState)("desc"),c=e=>{e===a?i("asc"===r?"desc":"asc"):(n(e),i("count"===e?"desc":"asc"))},o=(0,s.useMemo)(()=>[...e].sort((e,t)=>{let s=0;return s="topic"===a?e.topic.localeCompare(t.topic):e.count-t.count,"asc"===r?s:-s}),[e,a,r]),l=e=>e!==a?"\u21c5":"asc"===r?"\u2191":"\u2193";return 0===e.length?(0,m.jsx)("div",{className:p.emptyState,children:(0,m.jsx)("p",{children:"No topic data available for this period."})}):(0,m.jsx)("div",{className:p.container,children:(0,m.jsxs)("table",{className:p.table,children:[(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{className:p.rankColumn,children:"#"}),(0,m.jsxs)("th",{className:`${p.topicColumn} ${p.sortable}`,onClick:()=>c("topic"),children:["Topic ",l("topic")]}),(0,m.jsxs)("th",{className:`${p.countColumn} ${p.sortable}`,onClick:()=>c("count"),children:["Count ",l("count")]}),(0,m.jsx)("th",{className:p.percentColumn,children:"%"})]})}),(0,m.jsx)("tbody",{children:o.map((e,a)=>{const s=t>0?(e.count/t*100).toFixed(1):"0.0";return(0,m.jsxs)("tr",{children:[(0,m.jsx)("td",{className:p.rankColumn,children:a+1}),(0,m.jsx)("td",{className:p.topicColumn,children:(0,m.jsx)("span",{className:p.topicText,children:e.topic})}),(0,m.jsx)("td",{className:p.countColumn,children:(0,m.jsx)("span",{className:p.countBadge,children:e.count})}),(0,m.jsx)("td",{className:p.percentColumn,children:(0,m.jsxs)("span",{className:p.percentText,children:[s,"%"]})})]},`${e.topic}-${a}`)})})]})})}const _={container:"container_kX9H",label:"label_QDdX",presets:"presets_mgQ3",presetsButtons:"presetsButtons_tiQE",presetButton:"presetButton_YvJg",custom:"custom_Q9uY",customInputs:"customInputs_l1uD",inputGroup:"inputGroup_qTmD",inputLabel:"inputLabel_kbA_",dateInput:"dateInput_CYft",applyButton:"applyButton_w7pw",error:"error_Ezn1"},j=[{label:"Last 7 days",days:7},{label:"Last 30 days",days:30},{label:"Last 90 days",days:90}];function f({startDate:e,endDate:t,onDateRangeChange:a}){const[n,r]=(0,s.useState)(d(e)),[i,c]=(0,s.useState)(d(t)),[o,l]=(0,s.useState)(null);function d(e){return e.split("T")[0]}function u(e){return new Date(e+"T00:00:00Z").toISOString()}return(0,m.jsxs)("div",{className:_.container,children:[(0,m.jsxs)("div",{className:_.presets,children:[(0,m.jsx)("label",{className:_.label,children:"Quick Select:"}),(0,m.jsx)("div",{className:_.presetsButtons,children:j.map(e=>(0,m.jsx)("button",{type:"button",className:_.presetButton,onClick:()=>(e=>{const t=new Date,s=new Date;s.setDate(s.getDate()-e.days);const n={start_date:s.toISOString(),end_date:t.toISOString()};r(d(n.start_date)),c(d(n.end_date)),l(null),a(n)})(e),children:e.label},e.days))})]}),(0,m.jsxs)("div",{className:_.custom,children:[(0,m.jsx)("label",{className:_.label,children:"Custom Range:"}),(0,m.jsxs)("div",{className:_.customInputs,children:[(0,m.jsxs)("div",{className:_.inputGroup,children:[(0,m.jsx)("label",{htmlFor:"start-date",className:_.inputLabel,children:"Start Date"}),(0,m.jsx)("input",{id:"start-date",type:"date",value:n,onChange:e=>r(e.target.value),className:_.dateInput,max:d((new Date).toISOString())})]}),(0,m.jsxs)("div",{className:_.inputGroup,children:[(0,m.jsx)("label",{htmlFor:"end-date",className:_.inputLabel,children:"End Date"}),(0,m.jsx)("input",{id:"end-date",type:"date",value:i,onChange:e=>c(e.target.value),className:_.dateInput,max:d((new Date).toISOString())})]}),(0,m.jsx)("button",{type:"button",className:_.applyButton,onClick:()=>{const e=new Date(n),t=new Date(i);if(isNaN(e.getTime())||isNaN(t.getTime()))return void l("Invalid date format");if(t<=e)return void l("End date must be after start date");const s=new Date;e>s||t>s?l("Dates cannot be in the future"):(l(null),a({start_date:u(n),end_date:u(i)}))},children:"Apply"})]}),o&&(0,m.jsx)("p",{className:_.error,children:o})]})]})}const b={container:"container_w4FP",header:"header_geaa",subtitle:"subtitle_mxYM",section:"section_A1ab",sectionTitle:"sectionTitle_ih5Y",metricsGrid:"metricsGrid_XQtO",loading:"loading_kGOl",spinner:"spinner_Fdk3",spin:"spin_GzlQ",error:"error_nVb8",retryButton:"retryButton_iL5M",emptyState:"emptyState_iF2D",footer:"footer_RPrO",footerText:"footerText_drwY"};function g({bookId:e}){const{summary:t,loading:a,error:s,dateRange:n,setDateRange:r,refetch:i}=d({bookId:e,autoFetch:!0});return s?(0,m.jsx)("div",{className:b.container,children:(0,m.jsxs)("div",{className:b.error,children:[(0,m.jsx)("h2",{children:"Error Loading Analytics"}),(0,m.jsx)("p",{children:s}),(0,m.jsx)("button",{onClick:i,className:b.retryButton,children:"Retry"})]})}):(0,m.jsxs)("div",{className:b.container,children:[(0,m.jsxs)("header",{className:b.header,children:[(0,m.jsx)("h1",{children:"Chatbot Usage Analytics"}),(0,m.jsx)("p",{className:b.subtitle,children:"Monitor chatbot performance, user engagement, and teacher time savings"})]}),(0,m.jsx)(f,{startDate:n.start_date,endDate:n.end_date,onDateRangeChange:e=>{r(e)}}),a?(0,m.jsxs)("div",{className:b.loading,children:[(0,m.jsx)("div",{className:b.spinner}),(0,m.jsx)("p",{children:"Loading analytics..."})]}):t?(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)("section",{className:b.section,children:[(0,m.jsx)("h2",{className:b.sectionTitle,children:"Key Metrics"}),(0,m.jsxs)("div",{className:b.metricsGrid,children:[(0,m.jsx)(h,{title:"Total Queries",value:t.total_queries,format:"number",icon:"\ud83d\udcac",description:"Total number of student questions"}),(0,m.jsx)(h,{title:"Unique Users",value:t.unique_users,format:"number",icon:"\ud83d\udc65",description:"Students who used the chatbot"}),(0,m.jsx)(h,{title:"Teacher Time Saved",value:t.teacher_time_saved_minutes,format:"time",icon:"\u23f1\ufe0f",description:"Estimated time saved (2.5 min per query)"}),(0,m.jsx)(h,{title:"Feedback Rate",value:t.feedback_rate,format:"percentage",icon:"\ud83d\udcca",description:"Percentage of queries with feedback"})]})]}),(0,m.jsxs)("section",{className:b.section,children:[(0,m.jsx)("h2",{className:b.sectionTitle,children:"Quality Metrics"}),(0,m.jsxs)("div",{className:b.metricsGrid,children:[(0,m.jsx)(h,{title:"Average Confidence",value:(100*t.average_confidence).toFixed(1),format:"percentage",icon:"\ud83c\udfaf",description:"Average response confidence score"}),null!==t.positive_feedback_rate&&(0,m.jsx)(h,{title:"Positive Feedback",value:t.positive_feedback_rate,format:"percentage",icon:"\ud83d\udc4d",description:"Percentage of helpful ratings"})]})]}),(0,m.jsxs)("section",{className:b.section,children:[(0,m.jsx)("h2",{className:b.sectionTitle,children:"Response Latency"}),(0,m.jsxs)("div",{className:b.metricsGrid,children:[(0,m.jsx)(h,{title:"Median (p50)",value:t.latency_p50,format:"latency",icon:"\ud83d\udcc8",description:"50% of responses faster than this"}),(0,m.jsx)(h,{title:"95th Percentile",value:t.latency_p95,format:"latency",icon:"\ud83d\udcc8",description:"95% of responses faster than this"}),(0,m.jsx)(h,{title:"99th Percentile",value:t.latency_p99,format:"latency",icon:"\ud83d\udcc8",description:"99% of responses faster than this"})]})]}),(0,m.jsxs)("section",{className:b.section,children:[(0,m.jsx)("h2",{className:b.sectionTitle,children:"Top Question Topics"}),(0,m.jsx)(x,{topics:t.top_topics,totalQueries:t.total_queries})]}),(0,m.jsxs)("footer",{className:b.footer,children:[(0,m.jsxs)("p",{className:b.footerText,children:["Data period: ",new Date(t.start_date).toLocaleDateString()," -"," ",new Date(t.end_date).toLocaleDateString()]}),t.book_id&&(0,m.jsxs)("p",{className:b.footerText,children:["Book: ",t.book_id]})]})]}):(0,m.jsx)("div",{className:b.emptyState,children:(0,m.jsx)("p",{children:"No data available for the selected period."})})]})}function N(){return(0,m.jsx)(n.A,{title:"Analytics Dashboard",description:"Chatbot usage analytics and teacher workload insights",children:(0,m.jsx)("main",{children:(0,m.jsx)(g,{bookId:"physical-ai-robotics"})})})}}}]);